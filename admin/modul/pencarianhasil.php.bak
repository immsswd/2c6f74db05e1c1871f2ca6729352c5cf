
<?php include "modul/cari_buku.php";?>

<div class="col-md-12">
<div class="panel panel-default">
<div class="panel-heading"><h4 class="fa fa-search"></h4> Hasil Pencarian</div>
<div class="panel-body">
<?php
        if(isset($_POST['cari'])){
           $search = $_POST['search'];
        }
if(empty($_POST['search'])){
    echo "";
    $search = null;
}
$search = trim($search);
$search = preg_replace('/\s+/', ' ', $search);
 
//seperate multiple keywords into array space delimited
$keywords = explode(" ", $search);
//Clean empty arrays so they don't get every row as result
$keywords = array_diff($keywords, array(""));
//Set the MySQL query
if ($search == NULL or $search == '%'){
} else {
for ($i=0; $i<count($keywords); $i++) {
$query = "SELECT * FROM buku " .
"WHERE descr LIKE '%".$keywords[$i]."%'".
" ORDER BY id";
}
//Store the results in a variable or die if query fails
$result = mysqli_query($link, $query) or die();
}
if ($search == NULL or $search == '%'){
} else {
//Count the rows retrived
$count = mysqli_num_rows($result);
}
//If search variable is null do nothing, else print it.
if ($search == NULL) {
} else {
echo "<h3>Pencarian: <b><FONT COLOR=\"blue\">";
foreach($keywords as $value) {
   print "<u>".$value ."</u>";
}
echo "</font></b></h3>";
}
echo "<p> </p><br />";
echo "</center>";
//If users doesn't enter anything into search box tell them to.
if ($search == NULL){
echo "<center><b><FONT COLOR=\"red\">Please enter a search parameter to continue.</font><br><br></center>";
} elseif ($search == '%'){
echo "<center><b><FONT COLOR=\"red\">Please enter a search parameter to continue.</font><br><br></center>";
//If no results are returned print it
} elseif ($count <= 0){
echo "<center class='text-danger'>Pencarian yang anda maksud tidak terekam di database.<br><br><hr></center>";
//ELSE print the data in a table
} else {
//Table header
echo "<center><table id=\"search\" bgcolor=\"#AAAAAA\">";
echo "<tr>";
echo "<td><h3><strong></strong></h1><hr></t3>";
echo "<tr>";
echo "</table></center>";
//While there are rows, print it.
while($row = mysqli_fetch_array($result))
{
//table background color = row_color variable
echo "<table class='table table-hover'>";
echo "<tr>";
echo "<td> <a href='#'><h3> <i class='fa fa-external-link'></i>  ".$row['judul']."</h3></a></td>";
echo "</tr>";
echo "<tr>";
echo "<td>"."</td>";
echo "</tr>";
echo "<tr>";
echo "<td><p>".$row['descr']."</p></td>";
echo "</tr>";
?>
    <tr>
        <td> Kode Buku:<?php echo $row['kode'] ?></td>
    </tr>
    <tr>
        <td>Rak buku:<?=$row['rakbuku']?></td>
    </tr>
    <tr>
        <td> <strong>Pengarang:</strong> <?php echo $row['pengarang'] ?></td>
    </tr>
    <tr>
        <td><img src="<?=$row['fotobuku'] ?>" width="80" height="100"></td>
    </tr>
    <hr>
<?php
echo "<tr>";
echo "<td>"."</td>";
echo "</tr>";
echo "<tr>";
echo "<td>"."</td>";
echo "</tr>";
echo "</table>";
$row++;
//end while
}
//end if
}
echo "</body>";
echo "</html>";
if ($search == NULL or $search == '%') {
} else {
//clear memory
mysqli_free_result($result);
}
?>
</div>
</div>
</div>